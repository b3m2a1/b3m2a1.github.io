<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Required meta tags always come first -->
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>
Pretend Chemistry and Fake Objects |         b3m2a1

</title>
  <link rel="canonical" href="https://www.wolframcloud.com/objects/b3m2a1/home/-pretend-chemistry-and-fake-objects.html">

  <link rel="alternate" type="application/atom+xml" href="https://www.wolframcloud.com/objects/b3m2a1/home/feeds/all.atom.xml" title="Full Atom Feed">

  <link rel="apple-touch-icon" href="https://www.wolframcloud.com/objects/b3m2a1/home/apple-touch-icon.png" sizes="180x180">
  <link rel="icon" type="image/png" href="https://www.wolframcloud.com/objects/b3m2a1/home/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="https://www.wolframcloud.com/objects/b3m2a1/home/favicon-16x16.png" sizes="16x16">
  <link rel="manifest" href="https://www.wolframcloud.com/objects/b3m2a1/home/manifest.json">
  <meta name="theme-color" content="#333333">

  <link rel="stylesheet" href="https://www.wolframcloud.com/objects/b3m2a1/home/theme/css/bootstrap.css">
  <link rel="stylesheet" href="https://www.wolframcloud.com/objects/b3m2a1/home/theme/css/font-awesome.css">
  <link rel="stylesheet" href="https://www.wolframcloud.com/objects/b3m2a1/home/theme/css/style.css">


<meta name="description" content="I enjoy pretending to work with data whenever possible, be it a data scientist digging scraping and analyzing data from Stack Exchange or a looking at JPL spectra, but by far my favorite data to pretend to work with is wholly pretend chemical data. In fact, I like that so …">

<link href="https://www.wolframcloud.com/objects/b3m2a1/home/theme/prettify/styles/prettify-mma.min.css" rel="stylesheet">
<script src="https://www.wolframcloud.com/objects/b3m2a1/home/theme/prettify/src/prettify.js"></script>
<!-- <script src="https://www.wolframcloud.com/objects/b3m2a1/home/theme/prettify/src/lang-mma.min.js"></script> -->

<script>
  function moveWindow (){window.location.hash="main-content";}
</script>


<script>
  (function(i, s, o, g, r, a, m) {
    i['GoogleAnalyticsObject'] = r;
    i[r] = i[r] || function() {
      (i[r].q = i[r].q || []).push(arguments)
    }, i[r].l = 1 * new Date();
    a = s.createElement(o);
    a.async = 1;
    a.src = g;
    m = s.getElementsByTagName(o)[0];
    m.parentNode.insertBefore(a, m)
  })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');
  ga('create', 'UA-103560228-1', 'auto');
  ga('send', 'pageview');
</script>

  <script>
    function openNav() {
      var thumb = document.getElementById("nav-thumb");
      var bar = document.getElementById("side-nav");
      thumb.onclick= closeNav;
      bar.classList.add("right-bar-open");
      bar.classList.remove("right-bar-closed");
      thumb.classList.add("nav-thumb-open");
      thumb.classList.remove("nav-thumb-closed");
    }

    function closeNav() {
      var thumb = document.getElementById("nav-thumb");
      var bar = document.getElementById("side-nav");
      thumb.onclick= openNav;
      bar.classList.remove("right-bar-open");
      bar.classList.add("right-bar-closed");
      thumb.classList.remove("nav-thumb-open");
      thumb.classList.add("nav-thumb-closed")
    }
  </script>


</head>

<body onload="PR.prettyPrint(); moveWindow()"
>
  <header class="header">
    <div class="top-bar">
    <div class="site-image">
      <img src=https://www.wolframcloud.com/objects/b3m2a1/home/img/site-image.png alt="b3m2a1">
    </div>
    <div class="site-links bubble floating">
      <h1 class="title">
          <a href="https://www.wolframcloud.com/objects/b3m2a1/home/">
            b3m2a1
          </a>
        </h1>
        <ul
          class="list-inline row site-link-row"
          id="top-bar-link-row"
          >
            <li class="list-inline-item site-link">
              <a href="https://www.wolframcloud.com/objects/b3m2a1/home/pages/about.html">About</a>
            </li>
            <li class="list-inline-item site-link">
              <a href="https://www.wolframcloud.com/objects/b3m2a1/home/pages/contact.html">Contact</a>
            </li>
            <li class="list-inline-item site-link">
              <a href="https://www.wolframcloud.com/objects/b3m2a1/home/categories.html">Categories</a>
            </li>
            <li class="list-inline-item site-link">
              <a href="https://www.wolframcloud.com/objects/b3m2a1/home/tags.html">Tags</a>
            </li>
            <li class="list-inline-item site-link">
              <a href="https://www.wolframcloud.com/objects/b3m2a1/home/archives.html">Archives</a>
            </li>
        </ul>
    </div>
    </div>
  </header>

  <div class="main" id="main-content">

    <div class="right-bar right-bar-closed" id="side-nav">
      <button
        id="nav-thumb"
        class="nav-thumb nav-thumb-closed"
        onclick="openNav()"
        >
      </button>
      <div class="blogroll bubble inset">
        <p>Links</p>
        <ul class="blogroll-links right-bar-links list-inline">
            <li class="right-bar-item">
              <a href="https://github.com/b3m2a1" class="blogroll-link right-bar-link"
                target="_blank">
                GitHub
              </a>
            </li>
            <li class="right-bar-item">
              <a href="https://mathematica.stackexchange.com/users/38205" class="blogroll-link right-bar-link"
                target="_blank">
                StackExchange
              </a>
            </li>
            <li class="right-bar-item">
              <a href="https://www.wolframcloud.com/objects/b3m2a1.paclets/PacletServer/main.html" class="blogroll-link right-bar-link"
                target="_blank">
                Paclets
              </a>
            </li>
            <li class="right-bar-item">
              <a href="https://www.wolframcloud.com/objects/b3m2a1.docs/DocumentationSite/main.html" class="blogroll-link right-bar-link"
                target="_blank">
                Docs
              </a>
            </li>
          </ul>
      </div>
    </div>

    <div class="left-content">
      <div class="container">
        <h1>Pretend Chemistry and Fake Objects
</h1>
        <hr>
<article class="article">
  <header>
    <ul class="list-inline">
      <li class="list-inline-item text-muted" title="2017-07-27T00:47:55-05:00">
        <i class="fa fa-clock-o"></i>
        Thu 27 July 2017
      </li>
      <li class="list-inline-item">
        <i class="fa fa-folder-open-o"></i>
        <a href="https://www.wolframcloud.com/objects/b3m2a1/home/category/posts.html">posts</a>
      </li>
      <li class="list-inline-item">
        <i class="fa fa-user-o"></i>
        <a href="https://www.wolframcloud.com/objects/b3m2a1/home/author/b3m2a1.html">b3m2a1</a>      </li>
      <li class="list-inline-item">
        <i class="fa fa-files-o"></i>
        <a href="https://www.wolframcloud.com/objects/b3m2a1/home/tag/mathematica.html">#mathematica</a>      </li>
    </ul>
  </header>
  <div class="content">
    <p>I enjoy pretending to work with data whenever possible, be it a data scientist digging  <a href="https://www.wolframcloud.com/objects/b3m2a1/home/questions-on-the-mathematica-stack-exchange.html">scraping and analyzing data from Stack Exchange </a> or a looking at JPL spectra, but by far my favorite data to pretend to work with is wholly pretend chemical data. In fact, I like that so much I wrote a  <a href="http://www.wolframcloud.com/objects/b3m2a1.paclets/paclets/PacletServer/Paclets/ChemTools-1.1.1.paclet">whole package</a>  so I could pretend to work with it better.</p>
<p>The core of my package is a system to do object-oriented chemical modeling, but of course, with anything object-oriented we need a system for managing these objects. And with Mathematica this is not a trivial problem for two few reasons:</p>
<h3>Code as data plays poorly with mutability</h3>
<p>This is a pretty straight-forward observation. Except for a few odd instances:</p>
<pre class="prettyprint"><code>Keys@
  Select[
   AssociationThread[
    Names[&quot;System`*&quot;],
    Quiet[
     ToExpression[Names[&quot;System`*&quot;], StandardForm, FormatValues]]
    ],
   Not@*FreeQ[&quot;Interpretable&quot; -&gt; False]
   ] // ToExpression

(*Out:*)

{ActiveClassificationObject, ActivePredictionObject, \
BayesianMaximizationObject, BayesianMinimizationObject, ByteArray, \
ClassifierFunction, ClassifierMeasurementsObject, \
ContinuousWaveletData, DimensionReducerFunction, DiscreteWaveletData, \
EntityStore, FeatureDistance, FeatureExtractorFunction, \
InterpolatingFunction, LiftingFilterData, LinearSolveFunction, \
NearestFunction, OptimumFlowData, ParametricFunction, \
PredictorFunction, PredictorMeasurementsObject, \
SequencePredictorFunction, SparseArray, StructuredArray}</code></pre>


<p>Mathematica lives by the  <a href="https://en.wikipedia.org/wiki/Homoiconicity">code-as-data</a>  paradigm. Which I prefer to think of “if you can copy it, you can use it”, because I’m a trash programmer. What this means practically for us is that it’s impossible to mutate most of what we see or work with. In fact, the only truly mutable things in Mathematica are its  <a href="https://reference.wolfram.com/language/tutorial/ValuesForSymbols.html"><code>Symbols</code></a> .</p>
<p>This leads us to the fact that whatever we do, it will have be be either symbol based or managed by some other subsystem, such as a file-backed system (see  <a href="https://reference.wolfram.com/language/ref/LocalObject.html"><code>LocalObject</code></a>  or, if my spelunking is correct,  <a href="https://reference.wolfram.com/language/ref/ResourceObject.html"><code>ResourceObject</code></a> ) or Java (see JLink).</p>
<p>The  <code>Symbol</code> -based system seems to me to be the nicest way to do this. The question though, is how to do this well. Because we have another problem.</p>
<h3>Mathematica is slow</h3>
<p>Obviously some (much?) of Mathematica is  <a href="https://mathematica.stackexchange.com/q/148759/38205">blazing fast</a> . The problem is that all of that some is implemented at a low-level. And generally the slowness isn’t an issue. You can do so much with the internal stuff and with good  <a href="https://reference.wolfram.com/language/guide/FunctionalProgramming.html"><code>functional-programming</code></a>  design. But if we’re using a  <code>Symbol</code> -based system for managing objects and their properties this slowness quickly comes to get us. Consider the case of adding rules to a list:</p>
<pre class="prettyprint"><code>$obj = {};
Do[AppendTo[$obj, RandomReal[] -&gt; RandomReal[]], 
  10000] // AbsoluteTiming

(*Out:*)

{2.48031, Null}</code></pre>


<p>This nixes a  <code>Rule</code> -based system to my mind.</p>
<p>On the other hand, we can use an  <code>Association</code>  and get a lot better performance:</p>
<pre class="prettyprint"><code>$obj = &lt;||&gt;;
Do[$obj[RandomReal[]] = RandomReal[], 10000] // RepeatedTiming

(*Out:*)

{0.056, Null}</code></pre>


<p>That’s really not terrible, but unfortunately with things like inheritance and lookups in the mix things get hairier. Consider an object with three ancestors:</p>
<pre class="prettyprint"><code>$anc1 = AssociationThread[RandomReal[1, 10000], 
   RandomReal[1, 10000]];
$anc2 = AssociationThread[RandomReal[1, 10000], 
   RandomReal[1, 10000]];
$anc3 = AssociationThread[RandomReal[1, 10000], 
   RandomReal[1, 10000]];
obj = AssociationThread[RandomReal[1, 10000], RandomReal[1, 10000]];</code></pre>


<p>Let’s try looking up properties in the object, falling back to the ancestors if it’s not found:</p>
<pre class="prettyprint"><code>lookup[prop_] :=
   Lookup[$obj, prop,
     Lookup[$anc1, prop,
       Lookup[$anc2, prop,
         Lookup[$anc3, prop]
         ]
       ]
     ];
Do[lookup[RandomReal[]];, 10000] // AbsoluteTiming

(*Out:*)

{6.02145, Null}</code></pre>


<p>That is very slow. Obviously this is a semi-pathological case as each call is expected to bottom out, thus requiring 4 calls per  <code>Lookup</code> , but it’s still a good illustration of the performance we’re up against. And if we want to include any implicit method binding we’re gonna have some further issues.</p>
<p>On the other hand as long as we’re careful with our object design / usage we should be able to get through this largely unscathed.</p>
<p><a id="implementing-an-object-system" >&zwnj;</a></p>
<h2>Implementing an Object System</h2>
<p>We’ll set this up to use a similar system to Python. That is:</p>
<ul>
<li>
<p>Objects have types</p>
</li>
<li>
<p>Methods get bound to objects</p>
</li>
<li>
<p>There are properties which are bound methods that evaluate when accessed</p>
</li>
<li>
<p>Objects are glorified hash-maps</p>
</li>
</ul>
<p>But for the performance reasons stated above we’ll add one more thing that python doesn’t have:</p>
<ul>
<li>Everything important is vectorized (i.e. can be done over vectors)</li>
</ul>
<p>That means setting properties is vectorized, getting properties is vectorized, core object methods are vectorized, etc. </p>
<p>If we do this right we can go from this performance:</p>
<pre class="prettyprint"><code>$obj1 = &lt;||&gt;;
MapIndexed[Function[$obj1[#] = #2], Alphabet[]] // 
  RepeatedTiming // First

(*Out:*)

0.00012</code></pre>


<p>to this type of performance:</p>
<pre class="prettyprint"><code>$obj2 = &lt;||&gt;;
$obj2 = $obj2~Join~AssociationThread[Alphabet[], List /@ Range[26]] //
    RepeatedTiming // First

(*Out:*)

0.000083</code></pre>


<p>Which will pay dividends as things methods get more and more complex.</p>
<p>I’ll detail how one makes such an object system in a future post.</p>
<p><a id="pretend-chemistry" >&zwnj;</a></p>
<h2>Pretend Chemistry</h2>
<h3>Molecule Basics</h3>
<pre class="prettyprint"><code>&lt;&lt; ChemTools` (*Load the package*)</code></pre>


<p>With our objects in place we can start by just making an  <a href="https://www.wolframcloud.com/objects/b3m2a1.paclets/reference/ChemTools/guide/ChemAtomObject.html"><code>Atom</code></a>  to play with:</p>
<pre class="prettyprint"><code>H1 = CreateAtom[]
H1 // ChemView

(*Out:*)</code></pre>


<p><img alt="posts--pretend-chemistry-and-fake-objects-8043433411396612208" src="https://www.wolframcloud.com/objects/b3m2a1/home/img/posts--pretend-chemistry-and-fake-objects-8043433411396612208.png" /></p>
<pre class="prettyprint"><code>(*Out:*)</code></pre>


<p><img alt="posts--pretend-chemistry-and-fake-objects-1133207688272545070" src="https://www.wolframcloud.com/objects/b3m2a1/home/img/posts--pretend-chemistry-and-fake-objects-1133207688272545070.png" /></p>
<p>Then we can make another one and make a  <a href="https://www.wolframcloud.com/objects/b3m2a1.paclets/reference/ChemTools/guide/BondObject.html"><code>Bond</code></a>  between the two:</p>
<pre class="prettyprint"><code>H2 = CreateAtom[
   &quot;H&quot;, {ChemDataLookup[ChemDataQuery[&quot;H&quot;, &quot;H&quot;], &quot;BondDistances&quot;], 0, 
    0}];
bond = AtomCreateBond[H1, H2];
ChemView[{H1, H2, bond}]

(*Out:*)</code></pre>


<p><img alt="posts--pretend-chemistry-and-fake-objects-4709321471548277879" src="https://www.wolframcloud.com/objects/b3m2a1/home/img/posts--pretend-chemistry-and-fake-objects-4709321471548277879.png" /></p>
<p>And we can stick the atoms in an  <a href="https://www.wolframcloud.com/objects/b3m2a1.paclets/reference/ChemTools/guide/AtomsetObject.html"><code>Atomset</code></a>  container:</p>
<pre class="prettyprint"><code>hydrogen = CreateAtomset[{H1, H2}];
hydrogen // ChemView

(*Out:*)</code></pre>


<p><img alt="posts--pretend-chemistry-and-fake-objects-3873111683418317041" src="https://www.wolframcloud.com/objects/b3m2a1/home/img/posts--pretend-chemistry-and-fake-objects-3873111683418317041.png" /></p>
<p>And the fun thing about the mutability here is we can mutate this molecule, but have it be the same thing:</p>
<pre class="prettyprint"><code>hydrogen // InputForm;
ChemAnimate[
  hydrogen (*object*),
  ChemRotate[2 \[Pi]/36] (*action*),
  36 (*steps*),
  &quot;ChemViewOptions&quot; -&gt;
    {
      ViewPoint -&gt; {0, 0, 5},
      SphericalRegion -&gt; True,
      ImageSize -&gt; 200
      }
  ]

(*Out:*)</code></pre>


<p><img alt="posts--pretend-chemistry-and-fake-objects-6024403006935030645" src="https://www.wolframcloud.com/objects/b3m2a1/home/img/posts--pretend-chemistry-and-fake-objects-6024403006935030645.gif" /></p>
<p>The hydrogen is rotating, no doubt. But it’s always the exact same object, which lets us mutate it with  <a href="https://www.wolframcloud.com/objects/b3m2a1.paclets/reference/ChemTools/ref/ChemRotate.html"><code>ChemRotate</code></a>  without losing the object. As a further illustration we’ll just move the thing and see that its core data changes, but the object remains the same:</p>
<pre class="prettyprint"><code>hydrogen0 = hydrogen;
ChemGet[ChemGet[hydrogen, &quot;Atoms&quot;], &quot;Position&quot;]
AtomsetMove[hydrogen, {0, 0, 1}]
ChemGet[ChemGet[hydrogen, &quot;Atoms&quot;], &quot;Position&quot;]
hydrogen0 === hydrogen

(*Out:*)

{{0, 0, 0}, {1, 0, 0}}

(*Out:*)

{{0, 0, 1}, {1, 0, 1}}

(*Out:*)

True</code></pre>


<p>So the positions change, but the object remains the same. And we can see why:</p>
<pre class="prettyprint"><code>hydrogen // InputForm

(*Out:*)

ChemObject[&quot;System-default-dd404642-ef6b-4981-9313-a884bff5bce8&quot;, 
 &quot;Atomset-6-7fa0bcf3-ea91-46bd-a844-c8b65833daba&quot;]</code></pre>


<p>All it is is a pointer. And we can look at the core data:</p>
<pre class="prettyprint"><code>$ChemicalSystems[
  &quot;System-default-dd404642-ef6b-4981-9313-a884bff5bce8&quot;,
  &quot;Atomset-6-7fa0bcf3-ea91-46bd-a844-c8b65833daba&quot;
  ]

(*Out:*)</code></pre>


<p><img alt="posts--pretend-chemistry-and-fake-objects-6300440637767489451" src="https://www.wolframcloud.com/objects/b3m2a1/home/img/posts--pretend-chemistry-and-fake-objects-6300440637767489451.png" /></p>
<p>And as planned, the object is just a glorified  <code>Association</code> . Except, again, as planned, everything is vectorized. Consider the way we got our atom positions. It was a vectorized call. And we can set in a threaded, vectorized manner, too:</p>
<pre class="prettyprint"><code>ChemThreadSet[
   ChemGet[hydrogen, &quot;Atoms&quot;],
   &quot;Position&quot;,
   {{0, 0, 0}, {1, 0, 0}}
   ];
ChemGet[ChemGet[hydrogen, &quot;Atoms&quot;], &quot;Position&quot;]

(*Out:*)

{{0, 0, 0}, {1, 0, 0}}</code></pre>


<p>And here’s the benefit of this. Let’s make 1000 fluorine atoms and permute their positions randomly:</p>
<pre class="prettyprint"><code>AbsoluteTiming[
  fluorines = 
    CreateAtom[
     Thread[{&quot;F&quot;, RandomReal[{-10, 10}, {1000, 3}]}]];] // First

(*Out:*)

0.616614

timeVec =
  RepeatedTiming[
   ChemThreadSet[fluorines, &quot;Position&quot;, 
    RandomReal[{-10, 10}, {1000, 3}]]] // First

(*Out:*)

0.0096</code></pre>


<p>Doing that one-by-one:</p>
<pre class="prettyprint"><code>timeMap =
  RepeatedTiming[
     MapThread[
       ChemSet[#, &quot;Position&quot;, #2] &amp;,
       {
         fluorines,
         RandomReal[{-10, 10}, {1000, 3}]
         }
       ]] // First

(*Out:*)

0.017

timeMap/timeVec

(*Out:*)

1.8</code></pre>


<p>That’s a speed-up of almost 100%. Of course, it’s not always possible to permute positions all at once, but there are many problems whose implementations can be rewritten in such a way.</p>
<h3>Pretend Chemistry with Pretend Potentials</h3>
<p>One definite pleasure of working with Mathematica is the sheer volume of things it exposes natively. On that front we have not only a native link to  <a href="http://reference.wolfram.com/language/ref/service/PubChem.html">PubChem</a>  but also some nice  <a href="http://reference.wolfram.com/language/ref/Compile.html">pseudo-compilation</a>  and some attractive  <a href="http://reference.wolfram.com/language/ref/ListSliceDensityPlot3D.html">plotting over surfaces</a> .</p>
<p>Which means we can do cool stuff like easily import a molecule from PubChem:</p>
<pre class="prettyprint"><code>ChemImport[methyloxirane];
ChemView[methyloxirane]

(*Out:*)</code></pre>


<p><img alt="posts--pretend-chemistry-and-fake-objects-6568244822652880682" src="https://www.wolframcloud.com/objects/b3m2a1/home/img/posts--pretend-chemistry-and-fake-objects-6568244822652880682.png" /></p>
<p>But we can then also compile a function that plots its potential according to its  <a href="https://openbabel.org/wiki/Gasteiger-Marsili">Gasteiger charges</a> :</p>
<pre class="prettyprint"><code>AtomsetElectricPotential[methyloxirane]

(*Out:*)</code></pre>


<p><img alt="posts--pretend-chemistry-and-fake-objects-6022627865279295422" src="https://www.wolframcloud.com/objects/b3m2a1/home/img/posts--pretend-chemistry-and-fake-objects-6022627865279295422.png" /></p>
<p>And then plot that over its van der Waals surface:</p>
<pre class="prettyprint"><code>AtomsetElectricPotentialMap[methyloxirane]

(*Out:*)</code></pre>


<p><img alt="posts--pretend-chemistry-and-fake-objects-7586369624232882563" src="https://www.wolframcloud.com/objects/b3m2a1/home/img/posts--pretend-chemistry-and-fake-objects-7586369624232882563.png" /></p>
<p>And while there are obviously some sticky implementation details involved in, say, computing the Gasteiger charges, most everything involved in this can be done in fewer than 5 lines of code, which makes the life of the pretend chemist a lot easier.</p>
<h3>Pretend Chemistry meets Pretend Data-science</h3>
<p>But really that’s just a starting point for pretend science. We can do things one better by doing things like statistical surveys over whole classes of compounds. Maybe we’ll start with pulling in all our alkanes and their PubChem IDs (so we can sort out the ones without IDs):</p>
<pre class="prettyprint"><code>alkanes = EntityList@EntityClass[&quot;Chemical&quot;, &quot;Alkanes&quot;];
alkids = ChemDataLookup[alkanes, &quot;PubChemIDs&quot;];
idalks = Pick[alkanes, MatchQ[_Integer] /@ alkids];
idalks~Take~5 // Map[CommonName]

(*Out:*)

{&quot;2,2,4,6,6-pentamethylheptane&quot;, &quot;dodecylcyclohexane&quot;, \
&quot;trans-p-menthane&quot;, &quot;spiropentane&quot;, &quot;1,1-dimethylcyclopentane&quot;}</code></pre>


<p>So for most of these things we should be able to get a good 3D structure:</p>
<pre class="prettyprint"><code>alkobs = DeleteCases[ChemImport@idalks, $Failed];</code></pre>


<p>And we’ll upload these to the cloud for later access (the  <a href="https://www.wolframcloud.com/objects/b3m2a1.paclets/reference/ChemTools/ref/AtomsetWrapper.html"><code>AtomsetWrapper</code></a>  is a code-as-data wrapper that copies in the atomset data):</p>
<pre class="prettyprint"><code>alkcache = alkobs // Map[AtomsetWrapper];
CloudExport[alkcache, &quot;MX&quot;, &quot;alkane_object_uploads.mx&quot;, 
 Permissions -&gt; &quot;Public&quot;]

(*Out:*)

CloudObject[&quot;https://www.wolframcloud.com/objects/user-affd7b1c-ecb6-\
4ccc-8cc4-4d107e2bf04a/alkane_object_uploads.mx&quot;]</code></pre>


<p>If you want to import these for your own use (beware -- this remains unvectorized and so is slow):</p>
<pre class="prettyprint"><code>alkobs =
   Map[
     CreateAtomset,
     CloudImport@
       &quot;https://www.wolframcloud.com/objects/b3m2a1/alkane_object_\
uploads.mx&quot;
     ];</code></pre>


<p>Now let’s just look at some simple statistics</p>
<pre class="prettyprint"><code>alkobs // Length (* Number of molecules *)

alkatels = 
  ChemGet[ChemGet[alkobs, &quot;Atoms&quot;], 
   &quot;Element&quot;]; (* Atom types *)
alkatels // 
 Floor@*Mean@*Map[Length] (* Mean number of atoms *)
alkatels // 
 Floor@*Mean@*
  Map[Length@*Cases[&quot;C&quot;]] (* Mean number of carbons *)
alkatels // 
 Floor@*Mean@*Map[Length@*Cases[&quot;H&quot;]] (* Mean number of hydrogens *)

(*Out:*)

333

(*Out:*)

30

(*Out:*)

10

(*Out:*)

20</code></pre>


<p>Which gives us a sense for what we’re working with. From this we know our mean  <a href="https://chem.libretexts.org/Core/Organic_Chemistry/Alkenes/Properties_of_Alkenes/Degree_of_Unsaturation">degree of unsaturation</a>  will be:</p>
<pre class="prettyprint"><code>degUnsat[c_Integer, h_Integer] :=
   (2 c + 2 - h)/2;
degUnsat[m_List] :=

  degUnsat[Length@Cases[m, &quot;C&quot;], Length@Cases[m, &quot;H&quot;]];
degUnsat[10, 20]

(*Out:*)

1</code></pre>


<p>Which is weird, because we explicitly asked for alkanes, but ah well. I guess we’re just workign with hydrocarbons now. In any case, that means most of these things have either a double bond or a ring. Let’s just look at the spread of that:</p>
<pre class="prettyprint"><code>degsUn = degUnsat /@ alkatels;
Histogram[degsUn]

(*Out:*)</code></pre>


<p><img alt="posts--pretend-chemistry-and-fake-objects-2764214646475934148" src="https://www.wolframcloud.com/objects/b3m2a1/home/img/posts--pretend-chemistry-and-fake-objects-2764214646475934148.png" /></p>
<p>So really most of our sample is saturated alkanes and the small number of highly unsaturated hydrocarbons brings it down to the a DoU of 1.</p>
<p>And just for interest sake we’ll look at those 2 cases where the DoU is 5:</p>
<pre class="prettyprint"><code>(*Out:*)</code></pre>


<p><img alt="posts--pretend-chemistry-and-fake-objects-5689059598210857360" src="https://www.wolframcloud.com/objects/b3m2a1/home/img/posts--pretend-chemistry-and-fake-objects-5689059598210857360.png" /></p>
<p>And they’re both rather exotic species. The former being an interesting compound called  <a href="https://pubchem.ncbi.nlm.nih.gov/compound/Cubane">cubane</a>  and the latter being  <a href="https://pubchem.ncbi.nlm.nih.gov/compound/Cyclooctatetraene#section=Top">cyclooctatetranene</a>  a classic example of  <em><em>anti</em></em> -aromaticity. Both of which have the chemical formula C8H8.</p>
<p>Now as a final example of basic statistics we’ll look at mean bond lengths:</p>
<pre class="prettyprint"><code>alkbls = AtomsetMeanBondLengths[#, &quot;Type&quot;] &amp; /@ alkobs;

Merge[alkbls, Mean]
Merge[Pick[alkbls, 
  degUnsat[#] == 0 &amp; /@ alkatels], Mean] (* DoU = 0 *)
Merge[
 Pick[alkbls, 
  degUnsat[#] == 1 &amp; /@ alkatels], Mean] (* DoU = 1 *)
Merge[
 Pick[alkbls, 
  degUnsat[#] == 2 &amp; /@ alkatels], Mean] (* DoU = 2 *)
Merge[
 Pick[alkbls, 
  degUnsat[#] &gt;= 3 &amp; /@ alkatels], Mean] (* DoU \[GreaterEqual] 3 *)

(*Out:*)

&lt;|{&quot;C&quot;, &quot;C&quot;, 1} -&gt; 1.53156, {&quot;H&quot;, &quot;C&quot;, 1} -&gt; 1.09534, {&quot;C&quot;, &quot;S&quot;, 1} -&gt;
   1.82033, {&quot;H&quot;, &quot;S&quot;, 1} -&gt; 1.34111, {&quot;C&quot;, &quot;C&quot;, 2} -&gt; 
  1.33938, {&quot;C&quot;, &quot;Br&quot;, 1} -&gt; 1.87237, {&quot;C&quot;, &quot;O&quot;, 1} -&gt; 
  1.4219, {&quot;H&quot;, &quot;O&quot;, 1} -&gt; 0.972688|&gt;

(*Out:*)

&lt;|{&quot;C&quot;, &quot;C&quot;, 1} -&gt; 1.53617, {&quot;H&quot;, &quot;C&quot;, 1} -&gt; 1.09552, {&quot;C&quot;, &quot;S&quot;, 1} -&gt;
   1.82033, {&quot;H&quot;, &quot;S&quot;, 1} -&gt; 1.34111|&gt;

(*Out:*)

&lt;|{&quot;C&quot;, &quot;C&quot;, 1} -&gt; 1.52729, {&quot;H&quot;, &quot;C&quot;, 1} -&gt; 1.09552|&gt;

(*Out:*)

&lt;|{&quot;C&quot;, &quot;C&quot;, 1} -&gt; 1.52987, {&quot;H&quot;, &quot;C&quot;, 1} -&gt; 1.09534|&gt;

(*Out:*)

&lt;|{&quot;C&quot;, &quot;C&quot;, 1} -&gt; 1.52671, {&quot;H&quot;, &quot;C&quot;, 1} -&gt; 1.09336, {&quot;C&quot;, &quot;C&quot;, 2} -&gt;
   1.33931|&gt;</code></pre>


<p>So somehow our data is doubly weird. Not only is it not all alkanes, it’s not even all hydrocarbons:</p>
<pre class="prettyprint"><code>Pick[alkobs, MemberQ[Except[&quot;H&quot; | &quot;C&quot;]] /@ alkatels] // Length
Pick[alkobs, MemberQ[Except[&quot;H&quot; | &quot;C&quot;]] /@ alkatels]~Take~5 // 
 Map[ChemView]

(*Out:*)

13

(*Out:*)</code></pre>


<p><img alt="posts--pretend-chemistry-and-fake-objects-4412591671633706930" src="https://www.wolframcloud.com/objects/b3m2a1/home/img/posts--pretend-chemistry-and-fake-objects-4412591671633706930.png" /></p>
<p>and we would look at that more if we weren't doing pretend chemistry. But there are some other interesting things here to look at. For instance, our sample contains nothing with a triple bond, which is interesting, but a good thing in what was supposed to be alkanes.</p>
<p>On the other hand, it’s cool to see that the single and double bond lengths gleaned from this match with the expected values quite well, so that is some confirmation for what we did.</p>
<h3>Pretend Potentials and Pretend Data-science</h3>
<p>With that nice and played with, let’s move on to an even bigger joke. We’ll look at the Gasteiger electric potentials for straight alkane chains.</p>
<p>So first off, we need to find the 320 of our  <code>alkobs</code>  that are actually hydrocarbons. Then we’ll get the graphs of their carbon atoms so we can look at the branching:</p>
<pre class="prettyprint"><code>hydobs = Pick[alkobs, FreeQ[&quot;S&quot; | &quot;Br&quot; | &quot;O&quot;] /@ alkatels];
hydatels = Select[alkatels, FreeQ[&quot;S&quot; | &quot;Br&quot; | &quot;O&quot;]];
hydgraphs = 
  AtomGraph@
     ChemSelect[ChemGet[#, &quot;Atoms&quot;], &quot;Element&quot;, MatchQ[&quot;C&quot;]] &amp; /@ 
   hydobs;
hydgraphs~Take~3

(*Out:*)</code></pre>


<p><img alt="posts--pretend-chemistry-and-fake-objects-158966636736987118" src="https://www.wolframcloud.com/objects/b3m2a1/home/img/posts--pretend-chemistry-and-fake-objects-158966636736987118.png" /></p>
<p>And all three of these clearly need to be dropped, because they branch. We can compute that by figuring out the max chain length and comparing it to the number of nodes:</p>
<pre class="prettyprint"><code>straighthydobs =
   Pick[hydobs,
     Max[Flatten@#] === Length[#] - 1 &amp;@*GraphDistanceMatrix /@ 
    hydgraphs
     ];
straighthydobs~Take~5 // Map[ChemView]

(*Out:*)</code></pre>


<p><img alt="posts--pretend-chemistry-and-fake-objects-243256916633388502" src="https://www.wolframcloud.com/objects/b3m2a1/home/img/posts--pretend-chemistry-and-fake-objects-243256916633388502.png" /></p>
<p>And unfortunately we do only have like 17 of these, but that’s okay. Having so few may even be helpful. We’ll now reorient all of them so they align with one another:</p>
<pre class="prettyprint"><code>AtomsetAxisAlign[#, &quot;A&quot; -&gt; &quot;X&quot;] &amp; /@ straighthydobs;
straighthydobs // ChemView

(*Out:*)</code></pre>


<p><img alt="posts--pretend-chemistry-and-fake-objects-9108904329973232438" src="https://www.wolframcloud.com/objects/b3m2a1/home/img/posts--pretend-chemistry-and-fake-objects-9108904329973232438.png" /></p>
<p>And now just for fun we’ll calculate their sum electric potential:</p>
<pre class="prettyprint"><code>pots = AtomsetElectricPotential /@ straighthydobs;
pot =
  With[{pots = pots},
    Compile[{{p, _Real, 1}},
      Total[Through[pots[p]]]
      ]
    ]

(*Out:*)</code></pre>


<p><img alt="posts--pretend-chemistry-and-fake-objects-6593573407858417441" src="https://www.wolframcloud.com/objects/b3m2a1/home/img/posts--pretend-chemistry-and-fake-objects-6593573407858417441.png" /></p>
<p>And we can plot it, just a standard  <code>DensityPlot3D</code> :</p>
<pre class="prettyprint"><code>straightbounds = {-2, 2} + MinMax@Flatten@# &amp; /@ 
   Transpose[AtomsetBounds /@ straighthydobs];
DensityPlot3D[pot[{x, y, z}],
  Evaluate@Prepend[straightbounds[[1]], x],
  Evaluate@Prepend[straightbounds[[2]], y],
  Evaluate@Prepend[straightbounds[[3]], z]
  ]

(*Out:*)</code></pre>


<p><img alt="posts--pretend-chemistry-and-fake-objects-9004423531869264030" src="https://www.wolframcloud.com/objects/b3m2a1/home/img/posts--pretend-chemistry-and-fake-objects-9004423531869264030.png" /></p>
<p>Which gives pretty much what we’d expect, a blobby caterpillar, growing towards the middle.</p>
<p>We can obviously do lots more pretend chemistry, but that suffices, I think, for now, as a good sample of what a nice mixture of OOP and Mathematica can do.</p>
  </div>
</article>
<hr>
<div id="disqus_thread"></div>
<script>
  var disqus_config = function() {
    this.page.url = 'https://www.wolframcloud.com/objects/b3m2a1/home/-pretend-chemistry-and-fake-objects.html';
      this.page.identifier = 'b3m2a1-home-48543113-471f-4f5c-b861-eaac19c0178c';
;
  };
  (function() {
    var d = document;
    var s = d.createElement('script');
    s.src = '//b3m2a1-home.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  })();
</script>
<noscript class="text-muted">
  Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
      </div>
    </div>

  </div>

  <footer class="footer">
    <p class="col-sm-6 text-sm-right text-muted acknowledgement">
      Generated by
      <a href="https://github.com/getpelican/pelican" target="_blank">Pelican</a> /
      Forked from <a href="https://github.com/nairobilug/pelican-alchemy" target="_blank">alchemy</a>
    </p>
  </footer>

</body>

</html>