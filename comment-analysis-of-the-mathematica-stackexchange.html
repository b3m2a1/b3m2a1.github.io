<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Required meta tags always come first -->
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>
Comment Analysis of the Mathematica StackExchange |         b3m2a1

</title>
  <link rel="canonical" href="https://b3m2a1.github.io/comment-analysis-of-the-mathematica-stackexchange.html">

  <link rel="alternate" type="application/atom+xml" href="https://b3m2a1.github.io/feeds/all.atom.xml" title="Full Atom Feed">

  <link rel="apple-touch-icon" href="https://b3m2a1.github.io/apple-touch-icon.png" sizes="180x180">
  <link rel="icon" type="image/png" href="https://b3m2a1.github.io/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="https://b3m2a1.github.io/favicon-16x16.png" sizes="16x16">
  <link rel="manifest" href="https://b3m2a1.github.io/manifest.json">
  <meta name="theme-color" content="#333333">

  <link rel="stylesheet" href="https://b3m2a1.github.io/theme/css/bootstrap.css">
  <link rel="stylesheet" href="https://b3m2a1.github.io/theme/css/font-awesome.css">
  <link rel="stylesheet" href="https://b3m2a1.github.io/theme/css/style.css">


<meta name="description" content="For this post, I’m going to use a bunch of data I mined a few posts back to do a basic analysis of the comments on a forum like StackExchange. As per usual, I’m going to focus on the Mathematica StackExchange, as that is in some sense my …">

<link href="https://b3m2a1.github.io/theme/prettify/styles/prettify-mma.min.css" rel="stylesheet">
<script src="https://b3m2a1.github.io/theme/prettify/src/prettify.js"></script>
<!-- <script src="https://b3m2a1.github.io/theme/prettify/src/lang-mma.min.js"></script> -->

<script>
  function moveWindow (){window.location.hash="main-content";}
</script>


<script>
  (function(i, s, o, g, r, a, m) {
    i['GoogleAnalyticsObject'] = r;
    i[r] = i[r] || function() {
      (i[r].q = i[r].q || []).push(arguments)
    }, i[r].l = 1 * new Date();
    a = s.createElement(o);
    a.async = 1;
    a.src = g;
    m = s.getElementsByTagName(o)[0];
    m.parentNode.insertBefore(a, m)
  })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');
  ga('create', 'UA-103560228-1', 'auto');
  ga('send', 'pageview');
</script>

  <script>
    function openNav() {
      var thumb = document.getElementById("nav-thumb");
      var bar = document.getElementById("side-nav");
      thumb.onclick= closeNav;
      bar.classList.add("right-bar-open");
      bar.classList.remove("right-bar-closed");
      thumb.classList.add("nav-thumb-open");
      thumb.classList.remove("nav-thumb-closed");
    }

    function closeNav() {
      var thumb = document.getElementById("nav-thumb");
      var bar = document.getElementById("side-nav");
      thumb.onclick= openNav;
      bar.classList.remove("right-bar-open");
      bar.classList.add("right-bar-closed");
      thumb.classList.remove("nav-thumb-open");
      thumb.classList.add("nav-thumb-closed")
    }
  </script>


</head>

<body onload="PR.prettyPrint(); moveWindow()"
>
  <header class="header">
    <div class="top-bar">
    <div class="site-image">
      <img src=https://b3m2a1.github.io/img/site-image.png alt="b3m2a1">
    </div>
    <div class="site-links bubble floating">
      <h1 class="title">
          <a href="https://b3m2a1.github.io/">
            b3m2a1
          </a>
        </h1>
        <ul
          class="list-inline row site-link-row"
          id="top-bar-link-row"
          >
            <li class="list-inline-item site-link">
              <a href="https://b3m2a1.github.io/pages/about.html">About</a>
            </li>
            <li class="list-inline-item site-link">
              <a href="https://b3m2a1.github.io/pages/contact.html">Contact</a>
            </li>
            <li class="list-inline-item site-link">
              <a href="https://b3m2a1.github.io/categories.html">Categories</a>
            </li>
            <li class="list-inline-item site-link">
              <a href="https://b3m2a1.github.io/tags.html">Tags</a>
            </li>
            <li class="list-inline-item site-link">
              <a href="https://b3m2a1.github.io/archives.html">Archives</a>
            </li>
        </ul>
    </div>
    </div>
  </header>

  <div class="main" id="main-content">

    <div class="right-bar right-bar-closed" id="side-nav">
      <button
        id="nav-thumb"
        class="nav-thumb nav-thumb-closed"
        onclick="openNav()"
        >
      </button>
      <div class="blogroll bubble inset">
        <p>Links</p>
        <ul class="blogroll-links right-bar-links list-inline">
            <li class="right-bar-item">
              <a href="https://github.com/b3m2a1" class="blogroll-link right-bar-link"
                target="_blank">
                GitHub
              </a>
            </li>
            <li class="right-bar-item">
              <a href="https://mathematica.stackexchange.com/users/38205" class="blogroll-link right-bar-link"
                target="_blank">
                StackExchange
              </a>
            </li>
            <li class="right-bar-item">
              <a href="https://paclets.github.io/PacletServer" class="blogroll-link right-bar-link"
                target="_blank">
                Paclet Server
              </a>
            </li>
            <li class="right-bar-item">
              <a href="https://www.wolframcloud.com/objects/b3m2a1.docs/DocumentationServer/" class="blogroll-link right-bar-link"
                target="_blank">
                Docs
              </a>
            </li>
          </ul>
      </div>
    </div>

    <div class="left-content">
      <div class="container">
        <h1>Comment Analysis of the Mathematica StackExchange
</h1>
        <hr>
<article class="article">
  <header>
    <ul class="list-inline">
      <li class="list-inline-item text-muted" title="2017-12-17T00:00:00-06:00">
        <i class="fa fa-clock-o"></i>
        Sun 17 December 2017
      </li>
      <li class="list-inline-item">
        <i class="fa fa-folder-open-o"></i>
        <a href="https://b3m2a1.github.io/category/posts.html">posts</a>
      </li>
      <li class="list-inline-item">
        <i class="fa fa-user-o"></i>
        <a href="https://b3m2a1.github.io/author/b3m2a1.html">b3m2a1</a>      </li>
    </ul>
  </header>
  <div class="content">
    <p>For this post, I’m going to use a bunch of data I mined  <a href="../user-cohorts-on-the-stackexchange-network.html">a few posts back</a>  to do a basic analysis of the comments on a forum like StackExchange. As per usual, I’m going to focus on the Mathematica StackExchange, as that is in some sense my “home” community on the network.</p>
<p>I’m going to make all of this data publically accessible via the  <a href="https://www.wolframcloud.com">Wolfram Cloud</a> . It will live here:</p>
<pre class="prettyprint"><code>KeyChainConnect[&quot;DatasetsAccount&quot;]

(*Out:*)

&quot;b3m2a1.datasets@gmail.com&quot;

CloudObject[&quot;stack_exchange_data&quot;][[1]]

(*Out:*)

&quot;https://www.wolframcloud.com/objects/b3m2a1.datasets/stack_exchange_data&quot;</code></pre>


<p><a id="obtaining-the-data" style="width:0;height:0;margin:0;padding:0;">&zwnj;</a></p>
<h2>Obtaining the Data</h2>
<h3>Finding a set of commenters</h3>
<p>To start off, let’s import the cached version of my Mathematica user list:</p>
<pre class="prettyprint"><code>mUsers =
   CloudImport[&quot;stack_exchange_data/communities/mmaUsers.mx&quot;];</code></pre>


<p>Let’s then look at the different metrics we have to do analyses on:</p>
<pre class="prettyprint"><code>DeleteDuplicates[Flatten[Normal@Keys[mUsers]]] // Sort

(*Out:*)

{&quot;accept_rate&quot;, &quot;account_id&quot;, &quot;age&quot;, &quot;badge_counts&quot;, &quot;creation_date&quot;,
&quot;display_name&quot;, &quot;is_employee&quot;, &quot;last_access_date&quot;,
&quot;last_modified_date&quot;, &quot;link&quot;, &quot;location&quot;, &quot;profile_image&quot;,
&quot;reputation&quot;, &quot;reputation_change_day&quot;, &quot;reputation_change_month&quot;,
&quot;reputation_change_quarter&quot;, &quot;reputation_change_week&quot;,
&quot;reputation_change_year&quot;, &quot;timed_penalty_date&quot;, &quot;user_id&quot;,
&quot;user_type&quot;, &quot;website_url&quot;}</code></pre>


<p>There are lots of things we could roll with here, but I think the two  <em><em>most generally useful</em></em>  ones will be the  <code>"age"</code>  and  <code>"location"</code>  parameters. Since I looked at ages last time, lets look at them again.</p>
<p>First we’ll correlate age with IDs:</p>
<pre class="prettyprint"><code>idAges =
   DeleteMissing@Dataset@Association@Flatten@Normal[
         mUsers[All, #[&quot;user_id&quot;] -&gt; #[&quot;age&quot;] &amp;]];</code></pre>


<p>Then histogram out our ages again, just to recall what they looked like:</p>
<pre class="prettyprint"><code>Histogram[Values[idAges]]

(*Out:*)</code></pre>


<p><img alt="post-13-4372619971147133059" src="https://b3m2a1.github.io/img/post-13-4372619971147133059.png" /></p>
<p>Next we’ll see how we can gather user comments:</p>
<pre class="prettyprint"><code>$so = ServiceConnect[&quot;StackExchange&quot;]

(*Out:*)</code></pre>


<p><img alt="post-13-6144816761416980676" src="https://b3m2a1.github.io/img/post-13-6144816761416980676.png" /></p>
<p>The request for this will be the  <code>"UserComments"</code>  request:</p>
<pre class="prettyprint"><code>htmlImp[ds_] :=

  ImportString[StringRiffle[Normal[ds[All, &quot;body&quot;]], &quot;&lt;br/&gt;&lt;br/&gt;&quot;], 
   &quot;HTML&quot;];
htmlImp@$so[
   &quot;UserComments&quot;, 
   &quot;id&quot; -&gt; Keys[idAges][[1]], &quot;site&quot; -&gt; &quot;mathematica&quot;,
   &quot;filter&quot; -&gt; &quot;withbody&quot;,
   &quot;pagesize&quot; -&gt; &quot;5&quot;
   ]</code></pre>


<pre class="program"><code style="width: 100%; white-space: pre-wrap;">-----------Out-----------
Thanks for the info, that's good to know.

Let us continue this discussion in chat .

I will look into that, but you are the first one to report this problem. Are you sure it is not on your side (your reader)? I have not touched the pdf pretty much since I uploaded it back in 2009.

@AliHashmi Thanks. But it's been here for quite a while.

@b3m2a1It has been cross-platform since V10, if memory serves. With the caveats mentioned by Szabolcs.</code></pre>

<p>If we look at how long one of these requests at full size takes:</p>
<pre class="prettyprint"><code>htmlImp@$so[
     &quot;UserComments&quot;, 
     &quot;id&quot; -&gt; Keys[idAges][[1]],
     &quot;site&quot; -&gt; &quot;mathematica&quot;,
     &quot;filter&quot; -&gt; &quot;withbody&quot;,
     &quot;pagesize&quot; -&gt; &quot;100&quot;
     ] // AbsoluteTiming // First

(*Out:*)

1.46333</code></pre>


<p>We find that we definitely don’t want to do this for the full 7156 users. Given that I probably only am wiling to wait 5 minutes for this data to come in and have 8 cores to distribute over, let’s figure out how large a sample we can use:</p>
<pre class="prettyprint"><code>timing =
   htmlImp@$so[
        &quot;UserComments&quot;, 
        &quot;id&quot; -&gt; Keys[idAges][[1]],
        &quot;site&quot; -&gt; &quot;mathematica&quot;,
        &quot;filter&quot; -&gt; &quot;withbody&quot;,
        &quot;pagesize&quot; -&gt; &quot;100&quot;
        ] // AbsoluteTiming // First;
Quantity[5*8, &quot;Minutes&quot;]/Quantity[timing, &quot;Seconds&quot;]

(*Out:*)

1432.56</code></pre>


<p>So let’s take like 1500 users, where we try to get pretty even sampling over ages. To do this, we can first try to fit our data to an  <a href="https://reference.wolfram.com/language/ref/ExtremeValueDistribution.html"><code>ExtremeValueDistribution</code></a> :</p>
<pre class="prettyprint"><code>oldDist =
  EstimatedDistribution[Normal@Values@idAges, 
  ExtremeValueDistribution[α, β]]

(*Out:*)

ExtremeValueDistribution[26.8155, 6.90588]</code></pre>


<p>And then we’ll weight by the reciprocal of this:</p>
<pre class="prettyprint"><code>newIdAges =
   RandomSample[
     Values[#] -&gt; Keys[#] &amp;@
       Normal[Map[Evaluate[1/PDF[oldDist, #]] &amp;, idAges]],
     1500
     ];</code></pre>


<p>Then just to see how well we did:</p>
<pre class="prettyprint"><code>SmoothHistogram[
  {
    Lookup[Normal@idAges, newIdAges],
    Normal@Values[idAges]
    },
  PlotRange -&gt; All
  ]

(*Out:*)</code></pre>


<p><img alt="post-13-7403909869387610127" src="https://b3m2a1.github.io/img/post-13-7403909869387610127.png" /></p>
<p>We find that this did help smooth the distribution. But we might want to try to do a bit better. For that we could use a real  <a href="https://reference.wolfram.com/language/ref/SmoothKernelDistribution.html"><code>SmoothKernelDistribution</code></a> .</p>
<pre class="prettyprint"><code>oldDist =
   SmoothKernelDistribution[Normal@Values@idAges];
newIds =
   RandomSample[
     Values[#] -&gt; Keys[#] &amp;@
       Normal[Map[Evaluate[1/PDF[oldDist, #]] &amp;, idAges]],
     1500
     ];
SmoothHistogram[
  {
    Lookup[Normal@idAges, newIds],
    Normal@Values[idAges]
    },
  PlotRange -&gt; All
  ]

(*Out:*)</code></pre>


<p><img alt="post-13-8010102671074284783" src="https://b3m2a1.github.io/img/post-13-8010102671074284783.png" /></p>
<p>Which seems to have worked much better.</p>
<h3>Extracting the comments:</h3>
<p>With this in mind, we’re almost set actually mine this data. First let’s just do some quick checks that our users really have comments to their names:</p>
<pre class="prettyprint"><code>AbsoluteTiming[
   comms =
     AssociationMap[
       $so[
          &quot;UserComments&quot;, 
          &quot;id&quot; -&gt; #,
          &quot;site&quot; -&gt; &quot;mathematica&quot;,
          &quot;filter&quot; -&gt; &quot;withbody&quot;,
          &quot;pagesize&quot; -&gt; &quot;1&quot;
          ] &amp;,
       newIds
       ]
   ] // First

(*Out:*)

131.471

Select[comms, Length[#] &gt; 0 &amp;] // Length

(*Out:*)

375</code></pre>


<p>So we’re down to 375 users. Which is, I suppose, not terrible, but we’ll at least try to pad it back up a bit:</p>
<pre class="prettyprint"><code>newIds2 =
   RandomSample[
     Values[#] -&gt; Keys[#] &amp;@
       Normal@
         Map[
           Evaluate[1/PDF[oldDist, #]] &amp;, 
           KeyTake[idAges,
             Complement[Keys@idAges, newIds]
             ]
           ],
     1500
     ];</code></pre>


<p>And then once more we’ll prune like this:</p>
<pre class="prettyprint"><code>AbsoluteTiming[
   comms2 =
     AssociationMap[
       $so[
          &quot;UserComments&quot;, 
          &quot;id&quot; -&gt; #,
          &quot;site&quot; -&gt; &quot;mathematica&quot;,
          &quot;filter&quot; -&gt; &quot;withbody&quot;,
          &quot;pagesize&quot; -&gt; &quot;1&quot;
          ] &amp;,
       newIds2
       ]
   ] // First

(*Out:*)

129.244

Select[comms2, Length[#] &gt; 0 &amp;] // Length

(*Out:*)

348</code></pre>


<p>So between the two of these we have ~700 users. Still not many, but enough to start with.</p>
<p>Finally, we’ll get to mining the comments:</p>
<pre class="prettyprint"><code>AbsoluteTiming[
   idComments =
      AssociationMap[
        $so[
            &quot;QueryIterate&quot;,
            &quot;Request&quot; -&gt; &quot;UserComments&quot;, 
            &quot;id&quot; -&gt; #,
            &quot;site&quot; -&gt; &quot;mathematica&quot;,
            &quot;filter&quot; -&gt; &quot;withbody&quot;,
            &quot;MaxIterations&quot; -&gt; 10
            ] &amp;,
        Keys@Join[
           Select[comms, Length[#] &gt; 0 &amp;],
           Select[comms2, Length[#] &gt; 0 &amp;]
           ]
        ];
   ][[1]]

(*Out:*)

307.98</code></pre>


<p>And then we’ll dump these onto the cloud:</p>
<pre class="prettyprint"><code>CloudExport[idComments, &quot;MX&quot;,
&quot;stack_exchange_data/comments/mmaComments.mx&quot;,
  Permissions -&gt; &quot;Public&quot;
  ]

(*Out:*)

CloudObject[&quot;https://www.wolframcloud.com/objects/b3m2a1.datasets/stack_exchange_data/comments/mmaComments.mx&quot;]</code></pre>


<p><a id="distributions-in-mathematica-stackexchange-comments" style="width:0;height:0;margin:0;padding:0;">&zwnj;</a></p>
<h2>Distributions in Mathematica StackExchange comments</h2>
<h3>User comment counts</h3>
<p>Let’s just start by view in the distribution of comment numbers by user:</p>
<pre class="prettyprint"><code>SmoothHistogram[
  idComments // Map[Length] // Values,
  PlotRange -&gt; All
  ]

(*Out:*)</code></pre>


<p><img alt="post-13-7746140018277048762" src="https://b3m2a1.github.io/img/post-13-7746140018277048762.png" /></p>
<p>Which, somewhat unsurprisingly, shows a major peak around no comments and a minor peak at more-comments-than-I-imported. Of course, it is these comments by a small fraction of the site’s users that will tend to dominate this discussion, and they are simply so much more numerous (and generally longer).</p>
<h3>Comment lengths</h3>
<p>We can also break these apart by length:</p>
<pre class="prettyprint"><code>imppedComments =
   StringSplit[htmlImp@Apply[Join, Values[idComments]], &quot;\n\n&quot;];</code></pre>


<p>And given that that took a little to run, we can also dump this into the cloud:</p>
<pre class="prettyprint"><code>CloudExport[imppedComments, &quot;MX&quot;,
&quot;stack_exchange_data/comments/mmaSplitComments.mx&quot;,
  Permissions -&gt; &quot;Public&quot;
  ]

(*Out:*)

CloudObject[&quot;https://www.wolframcloud.com/objects/b3m2a1.datasets/stack_exchange_data/comments/mmaSplitComments.mx&quot;]</code></pre>


<p>Then we can look at average comment length:</p>
<pre class="prettyprint"><code>comLens = StringLength /@ imppedComments;
SmoothHistogram[comLens]

(*Out:*)</code></pre>


<p><img alt="post-13-3197814616888799598" src="https://b3m2a1.github.io/img/post-13-3197814616888799598.png" /></p>
<p>A few features stand out in this. The first is that we likely have two to three distributions hidden in here, which we can try to model as a  <a href="https://reference.wolfram.com/language/ref/MixtureDistribution.html"><code>MixtureDistribution</code></a>  of  <a href="https://reference.wolfram.com/language/ref/GammaDistribution.html"><code>GammaDistributions</code></a>  and  <a href="https://reference.wolfram.com/language/ref/NormalDistribution.html"><code>NormalDistributions</code></a> .</p>
<p>We’ll start by letting Mathematica provide a guess and comparing that to our observed distribution:</p>
<pre class="prettyprint"><code>comLenDist =
  FindDistribution[comLens,
    TargetFunctions -&gt; {NormalDistribution, GammaDistribution},
    PerformanceGoal -&gt; &quot;Quality&quot;
    ]
Show[
  SmoothHistogram[comLens],
  Plot[PDF[comLenDist, x],
    {x, 0, 650},
    PlotStyle -&gt; ColorData[97][2]
    ],
  PlotRange -&gt; All
  ]

(*Out:*)

MixtureDistribution[{0.83119, 
  0.16881}, {GammaDistribution[2.37578, 56.2346], 
  NormalDistribution[350.011, 133.508]}]

(*Out:*)</code></pre>


<p><img alt="post-13-1697851779570957717" src="https://b3m2a1.github.io/img/post-13-1697851779570957717.png" /></p>
<p>Which is, overall, a pretty good guess. But notably it misses that little hump up around 590 that I would argue is meaningful. So we’ll use this form as a base and add another distribution:</p>
<pre class="prettyprint"><code>comLenDist =
  EstimatedDistribution[
    comLens,
    MixtureDistribution[
      {big, mid, little},
      {
        GammaDistribution[α, β],
        NormalDistribution[μ, σ],
        NormalDistribution[μs, σs]
        }
      ],
    MixtureDistribution[
      {0.83, 0.17, .05},
      {
        GammaDistribution[2.73, 56.23],
        NormalDistribution[350.01, 133.51],
        NormalDistribution[590, 10]
        }
      ],
    AccuracyGoal -&gt; 20
    ]

(*Out:*)

MixtureDistribution[{0.823455, 0.158972, 
  0.017573}, {GammaDistribution[2.4218, 53.6177], 
  NormalDistribution[331.916, 108.543], 
  NormalDistribution[571.785, 19.2683]}]

Show[
  SmoothHistogram[comLens],
  Plot[
    PDF[comLenDist, x],
    {x, 0, 650},
    PlotStyle -&gt;
        ColorData[97][2],
    PlotRange -&gt; All
    ],
  PlotRange -&gt; All
  ]

(*Out:*)</code></pre>


<p><img alt="post-13-2315644765247144837" src="https://b3m2a1.github.io/img/post-13-2315644765247144837.png" /></p>
<p>We’ve lost some goodness of fit, but have recovered one of the obvious features of the distribution, so we’ll call that a win for now.</p>
<p>What’s interesting about this is the form. We can view this as its component distributions:</p>
<pre class="prettyprint"><code>Plot[
  Evaluate@
    Prepend[
      MapThread[#*PDF[#2, x] &amp;, List @@ comLenDist],
      PDF[comLenDist, x]
      ],
  {x, 0, 650},
  PlotRange -&gt; All
  ]

(*Out:*)</code></pre>


<p><img alt="post-13-1078334461258886281" src="https://b3m2a1.github.io/img/post-13-1078334461258886281.png" /></p>
<p>The feature up above 500 can be easily assigned to the reasonably common case where the allotted number of characters is insufficient. Often this even causes wrapping over into further comments.</p>
<p>The case of the primary peak around 100 is again reasonable, if perhaps on the high side.  Seeing as this sentence is ~100 characters, we can conclude that most comments are about a sentence long. If this seems high compared to general experience this may illustrate how little that is:</p>
<pre class="prettyprint"><code>StringRiffle[
  RandomSample[
    MinimalBy[
      Select[imppedComments, StringLength[#] == 100 &amp;],
      StringLength
      ],
    5
    ],
  &quot;\n\n&quot;
  ]</code></pre>


<pre class="program"><code style="width: 100%; white-space: pre-wrap;">-----------Out-----------
You'll probably have to write a webscraper. At least according to stackoverflow.com/q/5991756/421225

@user11946 I suggest you take a look at the tutorial here: reference.wolfram.com/language/tutorial/…

(# - 2)^2 (# + .5)^2 - 625/256 &[x], it seems that not all the roots can be found for this function.

There seems to be a bug. I get 5 for HenrikfindIndices[{0.1,0.2,0.3,0.6,0.8}, .7] and I expected 4 .

Please provide definitions for borderGCVector and linkGCVector . Your code doesn't run without them.</code></pre>

<p>On the other hand, even the absolute longest comments aren’t that much text. Here’re a few of them:</p>
<pre class="prettyprint"><code>StringRiffle[
  RandomSample[
    TakeLargestBy[imppedComments, StringLength, 10],
    2
    ],
  &quot;\n\n&quot;
  ]</code></pre>


<pre class="program"><code style="width: 100%; white-space: pre-wrap;">-----------Out-----------
@Pickett And when I saw it, I thought my world was about to change :-), but after discussing it with some more "knowledgeable people", although it was clear that the scope of these products was not yet very clear (or at least, to them), they all said that this would most likely be products to be integrated/used by editors of other products (that is medium to large scale businesses), and not really by individual users on a one case scenario... (it would be something like special licensing schemes, etc). But this was some time ago and probably the image is more clear now, and things have changed

Dear Yode, your approach in "treating" the image is very similar to the many attempts I made, before posting this question. Nonetheless, you were very successful at getting the lines over the sugarcane. The fact that there some misses is not very important, because one can always extrapolate the missing lines by looking at the most frequent distance between two lines (in a histogram). However, you approach will not work with a curved path, because of the function ImageLines, which only yields straight lines. Nonetheless, I am certain that your method will help me to improve on mine. Thank you.</code></pre>

<p>The mushy middle Gaussian is an interesting case where there’s just such a broad distribution of these random comment lengths. Looking at these isn’t particularly interesting, so we’ll leave them out.</p>
<p><a id="mathematica-stackexchange-comment-content" style="width:0;height:0;margin:0;padding:0;">&zwnj;</a></p>
<h2>Mathematica StackExchange comment content</h2>
<h3>Word clouds and word frequencies</h3>
<p>Finally we can start to play with some fun stuff. To start, let’s just make a word cloud of all of this stuff:</p>
<pre class="prettyprint"><code>comString = StringRiffle[imppedComments];
WordCloud[comString]

(*Out:*)</code></pre>


<p><img alt="post-13-8546085435734726015" src="https://b3m2a1.github.io/img/post-13-8546085435734726015.png" /></p>
<p>Unfortunately these aren’t terribly interesting. We could try removing some of these rather boring terms, but there’s no real reason to expect that this will dredge up anything fascinating.</p>
<p>We do see a few fun things, though, particularly in the prominence of single letters and numbers, like  <code>x</code> ,  <code>y</code> ,  <code>1</code> ,  <code>2</code> , etc.</p>
<p>These show that this is math driven site (unsurprisingly).</p>
<p>So let’s move to something more quantitative. First we’ll get the words and bin them by usage:</p>
<pre class="prettyprint"><code>comWords =
   TextCases[DeleteStopwords@comString, &quot;Word&quot;];
comCounts =
   Counts[ToLowerCase@comWords];</code></pre>


<p>Again I’ll dump these into the cloud, as they are computationally expensive:</p>
<pre class="prettyprint"><code>CloudExport[comCounts, &quot;MX&quot;,
&quot;stack_exchange_data/comments/mmaWordCounts.mx&quot;,
  Permissions -&gt; &quot;Public&quot;
  ]

(*Out:*)

CloudObject[&quot;https://www.wolframcloud.com/objects/b3m2a1.datasets/stack_exchange_data/comments/mmaWordCounts.mx&quot;]</code></pre>


<p>Next we’ll take the word frequencies over these words:</p>
<pre class="prettyprint"><code>wordFreqs =
   AssociationThread[
     Keys[comCounts],
     Rescale[1. Values[comCounts]]
     ];
TakeSmallest[wordFreqs, 10]

(*Out:*)

&lt;|&quot;whenevent[{s[1][t&quot; -&gt; 0., &quot;v.11.0.1&quot; -&gt; 0., &quot;249/250&quot; -&gt; 0., 
 &quot;10.13&quot; -&gt; 0., &quot;10.13.2&quot; -&gt; 0., &quot;floor[log[10&quot; -&gt; 0., &quot;2x+y&quot; -&gt; 0., 
 &quot;@louisb&quot; -&gt; 0., &quot;pureunities&quot; -&gt; 0., &quot;x^2+y&quot; -&gt; 0.|&gt;</code></pre>


<p>And we see from this that these aren’t really even words. So we’ll just drop them.</p>
<pre class="prettyprint"><code>wordFreqs2 =
   Select[wordFreqs, GreaterThan[.0005]];
TakeSmallest[wordFreqs2, 10]
TakeLargest[wordFreqs2, 10]

(*Out:*)

&lt;|&quot;mma8&quot; -&gt; 0.000542446, &quot;responsive&quot; -&gt; 0.000542446, 
 &quot;nasserm.abbasi&quot; -&gt; 0.000542446, &quot;10.10.4&quot; -&gt; 0.000542446, 
 &quot;ummm&quot; -&gt; 0.000542446, &quot;biases&quot; -&gt; 0.000542446, 
 &quot;sensor&quot; -&gt; 0.000542446, &quot;3.4&quot; -&gt; 0.000542446, 
 &quot;underdetermined&quot; -&gt; 0.000542446, &quot;k3&quot; -&gt; 0.000542446|&gt;

(*Out:*)

&lt;|&quot;question&quot; -&gt; 1., &quot;answer&quot; -&gt; 0.941416, &quot;code&quot; -&gt; 0.880662, 
 &quot;use&quot; -&gt; 0.803092, &quot;1&quot; -&gt; 0.763765, &quot;just&quot; -&gt; 0.725522, 
 &quot;mathematica&quot; -&gt; 0.72498, &quot;thanks&quot; -&gt; 0.718742, &quot;like&quot; -&gt; 0.670464, 
 &quot;function&quot; -&gt; 0.597776|&gt;</code></pre>


<p>These, on the other hand, are largely boring. But lets compare these frequencies to the standard  <a href="https://reference.wolfram.com/language/ref/WordFrequencyData.html"><code>WordFrequencyData</code></a>  to get a sense of what words might be abnormally present:</p>
<pre class="prettyprint"><code>wordFreqsReal =
   WordFrequencyData[
     Keys@TakeLargest[wordFreqs2, 500]
     ];
TakeSmallest[wordFreqsReal, 15]

(*Out:*)

&lt;|&quot;j.m.&quot; -&gt; 5.33713*10^-9, &quot;mma&quot; -&gt; 1.52723*10^-8, 
 &quot;mathematica&quot; -&gt; 2.4267*10^-8, &quot;workaround&quot; -&gt; 3.91462*10^-8, 
 &quot;wolfram&quot; -&gt; 4.27572*10^-8, &quot;mac&quot; -&gt; 1.81982*10^-7, 
 &quot;pdf&quot; -&gt; 2.23877*10^-7, &quot;ok&quot; -&gt; 4.88281*10^-7, 
 &quot;formatted&quot; -&gt; 6.09125*10^-7, &quot;+1&quot; -&gt; 9.20242*10^-7, 
 &quot;bug&quot; -&gt; 1.23268*10^-6, &quot;plotting&quot; -&gt; 1.63899*10^-6, 
 &quot;simplify&quot; -&gt; 1.77491*10^-6, &quot;kernel&quot; -&gt; 1.87406*10^-6, 
 &quot;notebook&quot; -&gt; 1.89268*10^-6|&gt;</code></pre>


<p>This is vaguely interesting, as we see a number of Mathematica specific terms ( <code>"workaround"</code> ,  <code>"formatted"</code> ) show up with very low frequency. But even more interesting is that  <code>"j.m"</code>  which is a reference to a user. We’ll handle that a bit later.</p>
<p>For now, we’ll go back to the case at hand. We’ll take our  <code>wordFreqs2</code>  and divide these out by out  <code>wordFreqsReal</code> :</p>
<pre class="prettyprint"><code>Take[
  wordFreqsNormmed =
    ReverseSort[TakeLargest[wordFreqs2, 500]/wordFreqsReal], 
  10]

(*Out:*)

&lt;|&quot;mr.wizard&quot; -&gt; 0.127204/Missing[&quot;NotAvailable&quot;], 
 &quot;@szabolcs&quot; -&gt; 0.102251/Missing[&quot;NotAvailable&quot;], 
 &quot;{x,&quot; -&gt; 0.0979116/Missing[&quot;NotAvailable&quot;], 
 &quot;@kuba&quot; -&gt; 0.0810957/Missing[&quot;NotAvailable&quot;], 
 &quot;{1,&quot; -&gt; 0.0550583/Missing[&quot;NotAvailable&quot;], 
 &quot;plotrange&quot; -&gt; 0.0474641/Missing[&quot;NotAvailable&quot;], 
 &quot;@belisarius&quot; -&gt; 0.0466504/Missing[&quot;NotAvailable&quot;], 
 &quot;ndsolve&quot; -&gt; 0.0450231/Missing[&quot;NotAvailable&quot;], 
 &quot;@michaele2&quot; -&gt; 0.0450231/Missing[&quot;NotAvailable&quot;], 
 &quot;{0,&quot; -&gt; 0.0436669/Missing[&quot;NotAvailable&quot;]|&gt;</code></pre>


<p>And we see two things. One, when we look at user names we’ll have to account for  <code>@</code>  mentions. Two, there are interesting terms like  <code>"ndsolve"</code>  that simply never come up outside of this context. There are fewer of these than there are junk terms like  <code>"{0"</code>  those, so we’ll just delete all of these.</p>
<pre class="prettyprint"><code>Take[Select[wordFreqsNormmed, NumberQ], 5]

(*Out:*)

&lt;|&quot;mathematica&quot; -&gt; 2.98751*10^7, &quot;j.m.&quot; -&gt; 1.64651*10^7, 
 &quot;mma&quot; -&gt; 1.22715*10^7, &quot;wolfram&quot; -&gt; 2.28994*10^6, 
 &quot;workaround&quot; -&gt; 997700.|&gt;</code></pre>


<p>And thus things like  <code>"mathematica"</code>  explode. So we’ll drop anything with size greater than  <p>10</p><sup>6</sup> .</p>
<pre class="prettyprint"><code>Take[
  wordFreqsNorm2 =
    Select[wordFreqsNormmed, LessThan[10^6]],
  5
  ]

(*Out:*)

&lt;|&quot;workaround&quot; -&gt; 997700., &quot;ok&quot; -&gt; 228296., &quot;mac&quot; -&gt; 220576., 
 &quot;pdf&quot; -&gt; 216856., &quot;+1&quot; -&gt; 213385.|&gt;</code></pre>


<p>And we start to see some fun things. Particularly the prominence of the word  <code>"workaround"</code> .  This could reflect the fact that many questions on the site do seem to be about workarounds for various not-entirely-there pieces of core functionality.</p>
<p>But let’s word-cloud these out (dropping  <code>"workaround"</code>  as it is another outlier)</p>
<pre class="prettyprint"><code>(*Out:*)</code></pre>


<p><img alt="post-13-3343543913608174526" src="https://b3m2a1.github.io/img/post-13-3343543913608174526.png" /></p>
<pre class="prettyprint"><code>WordCloud[Rest@wordFreqsNorm2]

(*Out:*)</code></pre>


<p><img alt="post-13-850464324379021256" src="https://b3m2a1.github.io/img/post-13-850464324379021256.png" /></p>
<p>We see that  <code>"+1"</code>  is very popular relative to standard word frequency, unsurprisingly. And  <code>"workaround"</code>  gets paired with the word  <code>"bug"</code></p>
<h3>Comment mentions vs. reputation</h3>
<p>We could, in fact, extract  <em><em>all</em></em>  of the users whose names appear in  <code>wordFreqs2</code> : </p>
<pre class="prettyprint"><code>userNames =
   StringDelete[
     ToLowerCase@Normal@
        Reverse@mUsers[SortBy[&quot;reputation&quot;], &quot;display_name&quot;], 
     Whitespace
     ];
KeyTake[wordFreqs, Take[userNames, 10]]

(*Out:*)

&lt;|&quot;mr.wizard&quot; -&gt; 0.127204, &quot;szabolcs&quot; -&gt; 0.0127475, 
 &quot;michaele2&quot; -&gt; 0.00081367, &quot;kglr&quot; -&gt; 0.00162734, 
 &quot;dr.belisarius&quot; -&gt; 0.00298346, &quot;kuba&quot; -&gt; 0.0105777, 
 &quot;jens&quot; -&gt; 0.00542446, &quot;j.m.&quot; -&gt; 0.0878763, &quot;halirutan&quot; -&gt; 0.0035259|&gt;</code></pre>


<p>And since the   <code>userNames</code>  are in reverse-reputation order this provides an interesting connection between reputation and comment mentions. Given that the API also provides a  <code>"UserMentions"</code>  request we could check this more directly, but for now we’ll use this as our proxy.</p>
<p>We can do a raw word cloud of the 100 highest-rep users:</p>
<pre class="prettyprint"><code>WordCloud@KeyTake[wordFreqs, Take[userNames, 100]]

(*Out:*)</code></pre>


<p><img alt="post-13-8956697085663054093" src="https://b3m2a1.github.io/img/post-13-8956697085663054093.png" /></p>
<p>Or we can normalize these by reputation:</p>
<pre class="prettyprint"><code>userNameReps =
   KeyTake[
     Association@Normal@
        mUsers[
          SortBy[&quot;reputation&quot;],

      StringDelete[ToLowerCase@#[&quot;display_name&quot;], Whitespace] -&gt; #[
         &quot;reputation&quot;] &amp;
          ],
     Keys@KeyTake[wordFreqs, Take[userNames, 100]]
     ];
WordCloud[
  KeyTake[wordFreqs, Keys[userNameReps]]/
    userNameReps
  ]

(*Out:*)</code></pre>


<p><img alt="post-13-4904227619359609533" src="https://b3m2a1.github.io/img/post-13-4904227619359609533.png" /></p>
<p>We can also scatter plot this same data. We’ll log plot it, too, to reduce the clumping</p>
<pre class="prettyprint"><code>ListPlot[
  Callout[{userNameReps[#], wordFreqs[#]}, #] &amp; /@ 
  Keys[userNameReps],
  AxesLabel -&gt; {&quot;reputation&quot;, &quot;mention frequency&quot;},
  ImageSize -&gt; 600,
  ScalingFunctions -&gt; {{Log, Exp}, {Log, Exp}},
  Epilog -&gt;
    {
      With[{f = 
      Fit[{userNameReps[#], wordFreqs[#]} &amp; /@ 
        Keys[userNameReps], {x}, x]},
        Line[
          Table[Log@{r, f /. (x -&gt; r)}, {r, {1, 220000}}]
          ]
        ]
      }
  ]

(*Out:*)</code></pre>


<p><img alt="post-13-32758575970514940" src="https://b3m2a1.github.io/img/post-13-32758575970514940.png" /></p>
<p>And we can see that, as expected, there is a connection between reputation and comment mentions, but a) it’s relatively weak and b) there are a number of users (most notably J.M. here) who are mentioned much more often in the comments than would be predicted directly from their reputation.</p>
<p>Also note that this is not total sample of all users. We are sampling only comments from a given subset of users and these comments are further dominated by a small number of users. If were were to take  <em><em>all</em></em>  comments I expect we would see a very different picture.</p>
<h3>Word types</h3>
<p>Finally, we’ll look at the types of words that are used in the comments. We’ll take a  <a href="https://reference.wolfram.com/language/ref/FeatureSpacePlot.html"><code>FeatureSpacePlot</code></a>  of the most common 100 with names longer than three letters, dropping the user names.</p>
<pre class="prettyprint"><code>featWrds =
   Select[
     Complement[
       Keys@
     TakeLargest[KeySelect[comCounts, StringLength[#] &gt; 3 &amp;], 300],
       Take[userNames, 100]
       ],
     StringMatchQ[LetterCharacter ..]
     ];</code></pre>


<p><a id="comment-types-by-age" style="width:0;height:0;margin:0;padding:0;">&zwnj;</a></p>
<h2>Comment Types by Age</h2>
<h3>Comment lengths by age</h3>
<p>Finally we’ll get to the purported point of  <em><em>this</em></em>  post, which was to pick apart the possible ways two people of particular ages might phrase  <em><em>their</em></em>  posts. Or, more concisely and with fewer word starting with p, how does age affect word choice in comments.</p>
<p>Let’s start by correlating our comments and ages of posters:</p>
<pre class="prettyprint"><code>idImpComs =
   StringSplit[htmlImp[#], &quot;\n\n&quot;] &amp; /@ idComments;

ageImpComs =
   Flatten@KeyValueMap[
      Thread[#2 -&gt;
          idAges[Key@#]
         ] &amp;,
      idImpComs
      ];</code></pre>


<p>And again we’ll dump this on the web:</p>
<pre class="prettyprint"><code>CloudExport[ageImpComs, &quot;MX&quot;,
&quot;stack_exchange_data/comments/mmaAgeTaggedComments.mx&quot;,
  Permissions -&gt; &quot;Public&quot;
  ]

(*Out:*)

CloudObject[&quot;https://www.wolframcloud.com/objects/b3m2a1.datasets/stack_exchange_data/comments/mmaAgeTaggedComments.mx&quot;]</code></pre>


<p>We can then group these things by age to take a look at the length of the average post for a person of a given age:</p>
<pre class="prettyprint"><code>ageImpGroupComs =
   GroupBy[ageImpComs, Last -&gt; First];</code></pre>


<p>One thing to remember is that around three quarters of these posts will be been written by someone between the ages of 20 and 60, so this is the population we will primarily be probing.</p>
<pre class="prettyprint"><code>ageComsWeighted =
   Map[Length, ageImpGroupComs] // 
   WeightedData[Keys[#], Values[#]] &amp;;
ageComsDist =
   ageComsWeighted //
     SmoothKernelDistribution;
ageComsCDF =
   Evaluate[
      CDF[ageComsDist, #]
      ] &amp;;
ageComsPDF =
   Evaluate[
      PDF[ageComsDist, #]
      ] &amp;;
ageComsCDF[60] - ageComsCDF[20]
Grid@{
   {
     Plot[ageComsPDF[x],
       {x, 0, 100},
       PlotLabel -&gt; &quot;Probability density by commenter age&quot;,
       AxesLabel -&gt; {&quot;age (years)&quot;},
       ImageSize -&gt; 250
       ],
     Histogram[ageComsWeighted,
       PlotLabel -&gt; &quot;Length histogram by age&quot;,
       AxesLabel -&gt; {&quot;age (years)&quot;},
       ImageSize -&gt; 250
       ]
     },
   {
     Plot[ageComsCDF[x],
       {x, 0, 100},
       PlotLabel -&gt; &quot;Cumulative probability by age&quot;,
       AxesLabel -&gt; {&quot;age (years)&quot;},
       ImageSize -&gt; 250
       ]
     }
   }

(*Out:*)

0.74258

(*Out:*)</code></pre>


<table class="grid"><tbody><tr><td><img src="https://b3m2a1.github.io/img/post-13-8655081948500323418.png" alt="post-13-8655081948500323418"/></td><td><img src="https://b3m2a1.github.io/img/post-13-5595226195941596246.png" alt="post-13-5595226195941596246"/></td></tr><tr><td><img src="https://b3m2a1.github.io/img/post-13-1415125505100810903.png" alt="post-13-1415125505100810903"/></td><td><p>Null</p></td></tr></tbody></table>

<p>First, we’ll look at mean comment length by age. To start let’s just look at what we’re working with:</p>
<pre class="prettyprint"><code>ageMeanComLens =
   Reverse@KeySort[Mean@*Map[StringLength] /@ ageImpGroupComs];
ListLinePlot[
  List @@@ Normal@ageMeanComLens,
  PlotRange -&gt; All,
  AxesLabel -&gt; {&quot;user age (years)&quot;, &quot;mean len (chars)&quot;}
  ]

(*Out:*)</code></pre>


<p><img alt="post-13-6724301368509613387" src="https://b3m2a1.github.io/img/post-13-6724301368509613387.png" /></p>
<p>This is all pretty messy. We’ll re-bin and re-average to smooth this out, but first we’ll see what’s going on around 18:</p>
<pre class="prettyprint"><code>N@KeySelect[ageMeanComLens, Between[{15, 18}]]

(*Out:*)

&lt;|18 -&gt; 131.912, 17 -&gt; 277.296, 16 -&gt; 98.1176, 15 -&gt; 85.|&gt;</code></pre>


<p>So we see something is going on ~17. If we look at our population of 17-year-old users, we have a small number of them:</p>
<pre class="prettyprint"><code>Length[
  theYouths =
    Select[Keys@idImpComs, idAges[Key@#] == 17 &amp;]
  ]

(*Out:*)

6

{N@Mean@Map[StringLength, #], Length[#]} &amp; /@

 Lookup[idImpComs, theYouths]

(*Out:*)

{{108.667, 3}, {145., 10}, {110., 1}, {146.5, 2}, {280.777, 
  779}, {50.5, 2}}</code></pre>


<p>We see we have one very active, very chatty 17 year old who is contributing most of this. Since most people first see Mathematica in college and one would expect a 17 year old would been in his or her first semester of college, it is particularly surprising they’re so active. Just to confirm, let’s see when they made their account:</p>
<pre class="prettyprint"><code>FromUnixTime@
 First@mUsers[Select[#[&quot;user_id&quot;] == theYouths[[-2]] &amp;], 
   &quot;creation_date&quot;]

(*Out:*)</code></pre>


<p><img alt="post-13-764833167556008518" src="https://b3m2a1.github.io/img/post-13-764833167556008518.png" /></p>
<p>Which would suggest they were 12 at the time, which seems entirely implausible (and StackExchange probably doesn’t even allow that). So we’ll write them off as having their age mislabeled.</p>
<p>Returning to the original thread, we'll re-bin by 5 year increments, routing through  <a href="https://reference.wolfram.com/language/ref/EventSeries.html"><code>EventSeries</code></a>  to get the  <a href="https://reference.wolfram.com/language/ref/Quantity.html"><code>Quantity</code></a>  spec in.</p>
<pre class="prettyprint"><code>ageComLens =
   KeySort[{Mean[#], Length[#]} &amp;@*Map[StringLength] /@ 
    ageImpGroupComs];
ageComLenES =
   MovingMap[
     Mean@Flatten@
         Map[
           ConstantArray[#[[1]], #[[2]]] &amp;,
           #
           ] &amp;,
     EventSeries[
       KeyMap[DateObject[{2000}] + Quantity[#, &quot;Years&quot;] &amp;, 
     ageComLens]
       ],
     Quantity[5, &quot;Years&quot;]
     ];
ageComLenPlotListFull =
   Map[
     {QuantityMagnitude[Round[#[[1]] - DateObject[{2000}]]], #[[2]]} &amp;,
     ageComLenES[&quot;DatePath&quot;]
     ];
ListLinePlot[ageComLenPlotListFull, 
  AxesLabel -&gt; {&quot;user age (years)&quot;, &quot;mean len (chars)&quot;}, 
  PlotRange -&gt; All
  ]

(*Out:*)</code></pre>


<p><img alt="post-13-3685666646788965473" src="https://b3m2a1.github.io/img/post-13-3685666646788965473.png" /></p>
<p>This is still quite messy (and we have a few people claiming, implausibly, to be well into their nineties or above). So we’ll ignore anything over 85 or so.</p>
<pre class="prettyprint"><code>ageComLenPlotList =
   Map[
     {QuantityMagnitude[Round[#[[1]] - DateObject[{2000}]]], #[[2]]} &amp;,
     TimeSeriesWindow[ageComLenES,
        DateObject[{2000}] + {Quantity[0, &quot;Years&quot;], 
       Quantity[85, &quot;Years&quot;]}
        ][&quot;DatePath&quot;]
     ];
ListLinePlot[ageComLenPlotList, 
 AxesLabel -&gt; {&quot;user age (years)&quot;, &quot;mean len (chars)&quot;}]

(*Out:*)</code></pre>


<p><img alt="post-13-2017137824475339896" src="https://b3m2a1.github.io/img/post-13-2017137824475339896.png" /></p>
<p>This is still quite messy, but in general, we can see from this that verbosity seems to decrease with age. Of course, we are averaging over many many more at the younger ages, so a few rather terse users in their seventies can put quite a skew on the data. This overall trend does make sense, however, with regards to  <a href="http://journals.sagepub.com/doi/abs/10.1177/0261927X14526993">recent research on how people communicate based on social status</a> . That older people would be more comfortable being terser could be a reasonable corollary to that.</p>
<p>Of course, this effect is small and the underlying data is bad, but it’s a fun possible interpretation.</p>
<h3>Comment content</h3>
<p>Another interesting thing to look at is comment sentiment. Mathematica supports the absolute most basic sentiment analysis in  <a href="https://reference.wolfram.com/language/ref/Classify.html"><code>Classify</code></a>  so we’ll first fragment our comments into sentences:</p>
<pre class="prettyprint"><code>ageComSentences =
   Map[TextCases[StringRiffle[#, &quot;\n\n&quot;], &quot;Sentences&quot;] &amp;, 
   ageImpGroupComs];</code></pre>


<p>Then classify all of these by sentiment. We’ll then do a simple -1, 0, 1 translation of these sentiments:</p>
<pre class="prettyprint"><code>ageComSents =
   Replace[
       Classify[&quot;Sentiment&quot;, #],
       {
         &quot;Positive&quot; -&gt; 1,
         &quot;Neutral&quot; -&gt; 0,
         &quot;Negative&quot; -&gt; -1,
         Indeterminate -&gt; Nothing
         },
       {1}
       ] &amp; /@ ageComSentences;</code></pre>


<p>Then we’ll just look at the mean of all of these sentiments as a function of age:</p>
<pre class="prettyprint"><code>ListPlot[List @@@ Normal[Mean /@ ageComSents], PlotRange -&gt; All]

(*Out:*)</code></pre>


<p><img alt="post-13-519715183535349420" src="https://b3m2a1.github.io/img/post-13-519715183535349420.png" /></p>
<p>And so in general these sentiments skew a negative, but not terribly so. And that in many ways makes sense, as almost always people come to StackExchange because they have an issue they want resolved.</p>
<p>Next we'll do the same binning procedure as last time to get a less noisy version of this:</p>
<pre class="prettyprint"><code>ageComSentLens =
   KeySort[{Mean[#], Length[#]} &amp; /@ ageComSents];
ageComSentES =
   MovingMap[
     Mean@Flatten@
         Map[
           ConstantArray[#[[1]], #[[2]]] &amp;,
           #
           ] &amp;,
     EventSeries[
       KeyMap[DateObject[{2000}] + Quantity[#, &quot;Years&quot;] &amp;, 
     ageComSentLens]
       ],
     Quantity[5, &quot;Years&quot;]
     ];
ageComSentPlotList =
   Map[
     {QuantityMagnitude[Round[#[[1]] - DateObject[{2000}]]], #[[2]]} &amp;,
     TimeSeriesWindow[ageComSentES,
        DateObject[{2000}] + {Quantity[0, &quot;Years&quot;], 
       Quantity[85, &quot;Years&quot;]}
        ][&quot;DatePath&quot;]
     ];
ListLinePlot[ageComSentPlotList, 
  AxesLabel -&gt; {&quot;user age (years)&quot;, &quot;mean sentiment&quot;}, 
 PlotRange -&gt; All]

(*Out:*)</code></pre>


<p><img alt="post-13-8572033510883230480" src="https://b3m2a1.github.io/img/post-13-8572033510883230480.png" /></p>
<p>And here we find there is absolutely no connection between comment sentiment and age, belying the common stereotype of the crotchety old person. On StackExchange, instead, we are all crotchety, young and old.</p>
<p>Another interesting thing to look at is the spread of the sentiments. For this we’ll stack a bunch of  <code>Histogram</code>  to make a 3D plot. Just to make life more manageable we’ll group by years of five.</p>
<pre class="prettyprint"><code>ageComSentsFiveGroups =
   KeySort@GroupBy[
      Normal@KeySelect[ageComSents, LessThan[85]],
      5*Quotient[#[[1]], 5, 1] &amp; -&gt; Last,
      Flatten
      ];
ageComSentHist =
  Histogram3D[
    KeyValueMap[
      Thread[{#, #2}] &amp;,
      ageComSentsFiveGroups
      ],
    Automatic,
    &quot;Probability&quot;,
    ChartStyle -&gt; {Opacity[1], Automatic}
    ]

(*Out:*)</code></pre>


<p><img alt="post-13-8539708815315518962" src="https://b3m2a1.github.io/img/post-13-8539708815315518962.png" /></p>
<p>And here we can see there might actually be age-dependent trends each different sentiment that were cancelling in the mean.</p>
<p>For those interested, I’ve dumped this plot here:</p>
<pre class="prettyprint"><code>CloudDeploy[
  ageComSentHist,
  &quot;stack_exchange_data/comments/mmaCommentsAgeSentiments.nb&quot;, 
  Permissions -&gt; &quot;Public&quot;
  ]

(*Out:*)

CloudObject[&quot;https://www.wolframcloud.com/objects/b3m2a1.datasets/stack_exchange_data/comments/mmaCommentsAgeSentiments.nb&quot;]</code></pre>


<p>Once the cloud supports all  <code>Graphics3D</code>  primitives that will be viewable in 3D. For now you can always download the notebook with  <code>CloudImport</code></p>
<h3>Age vs Individual Sentiments</h3>
<p>The most striking progression in that seems to be the decrease in positive sentiment in posts with age, so we’ll start by looking at that:</p>
<pre class="prettyprint"><code>ageComSentsPosLens =
   KeySort[{Length[Cases[#, 1]], Length[#]} &amp; /@ ageComSents];
ageComSentPosES =
   MovingMap[
     Total[#[[All, 1]]]/Total[#[[All, 2]]] &amp;,
     EventSeries[
       KeyMap[DateObject[{2000}] + Quantity[#, &quot;Years&quot;] &amp;, 
     ageComSentsPosLens]
       ],
     Quantity[5, &quot;Years&quot;]
     ];
ageComSentPosPlotList =
   Map[
     {QuantityMagnitude[Round[#[[1]] - DateObject[{2000}]]], #[[2]]} &amp;,
     TimeSeriesWindow[ageComSentPosES,
        DateObject[{2000}] + {Quantity[0, &quot;Years&quot;], 
       Quantity[85, &quot;Years&quot;]}
        ][&quot;DatePath&quot;]
     ];
ListLinePlot[ageComSentPosPlotList, 
  AxesLabel -&gt; {&quot;user age (years)&quot;, &quot;percent positive&quot;}, 
 PlotRange -&gt; All]

(*Out:*)</code></pre>


<p><img alt="post-13-1802229423784582497" src="https://b3m2a1.github.io/img/post-13-1802229423784582497.png" /></p>
<p>With this better sampling procedure much of what we saw before disappears. We can still check, though, what happens when plot all three sentiments simultaneously:</p>
<pre class="prettyprint"><code>ageComSentsNeutLens =
   KeySort[{Length[Cases[#, 0]], Length[#]} &amp; /@ ageComSents];
ageComSentNeutES =
   MovingMap[
     Total[#[[All, 1]]]/Total[#[[All, 2]]] &amp;,
     EventSeries[
       KeyMap[DateObject[{2000}] + Quantity[#, &quot;Years&quot;] &amp;, 
     ageComSentsNeutLens]
       ],
     Quantity[5, &quot;Years&quot;]
     ];
ageComSentNeutPlotList =
   Map[
     {QuantityMagnitude[Round[#[[1]] - DateObject[{2000}]]], #[[2]]} &amp;,
     TimeSeriesWindow[ageComSentNeutES,
        DateObject[{2000}] + {Quantity[0, &quot;Years&quot;], 
       Quantity[85, &quot;Years&quot;]}
        ][&quot;DatePath&quot;]
     ];
ageComSentsNegLens =
   KeySort[{Length[Cases[#, -1]], Length[#]} &amp; /@ ageComSents];
ageComSentNegES =
   MovingMap[
     Total[#[[All, 1]]]/Total[#[[All, 2]]] &amp;,
     EventSeries[
       KeyMap[DateObject[{2000}] + Quantity[#, &quot;Years&quot;] &amp;, 
     ageComSentsNegLens]
       ],
     Quantity[5, &quot;Years&quot;]
     ];
ageComSentNegPlotList =
   Map[
     {QuantityMagnitude[Round[#[[1]] - DateObject[{2000}]]], #[[
      2]]} &amp;,
     TimeSeriesWindow[ageComSentNegES,
        DateObject[{2000}] + {Quantity[0, &quot;Years&quot;], 
       Quantity[85, &quot;Years&quot;]}
        ][&quot;DatePath&quot;]
     ];
ListLinePlot[
  {
    ageComSentPosPlotList, 
    ageComSentNeutPlotList,
    ageComSentNegPlotList
    },
  AxesLabel -&gt; {&quot;user age (years)&quot;, &quot;percent sentiment&quot;}, 
  PlotRange -&gt; All,
  PlotLegends -&gt; {&quot;positive&quot;, &quot;neutral&quot;, &quot;negative&quot;}
  ]

(*Out:*)</code></pre>


<p><img alt="post-13-7306078627986006019" src="https://b3m2a1.github.io/img/post-13-7306078627986006019.png" /></p>
<p>And here we see something interesting. Negative sentiment was pretty constant across ages, but the except in a few instances (I’m looking at you, 55 and 62 year olds), positive and neutral sentiments were coupled.</p>
<p>What this means I have no idea, but it is an interesting result none-the-less.</p>
<h3>Verbosity vs Sentiment</h3>
<p>One might be interested in whether the two trends we’ve looked at, verbosity and sentiment, are connected. We can plot this by pulling from these plot lists and doing a direct correlation:</p>
<pre class="prettyprint"><code>ListPlot[
  Thread[
    {
      ageComLenPlotList[[All, 2]],
      ageComSentPlotList[[All, 2]]
      }
    ],
  AxesLabel -&gt;
    {
      &quot;mean len (char)&quot;,
      &quot;mean sentiment&quot;
     }
  ]

(*Out:*)</code></pre>


<p><img alt="post-13-7237648988165766660" src="https://b3m2a1.github.io/img/post-13-7237648988165766660.png" /></p>
<p>And that’s a decently convincing connection between increasing mean comment length and sentiment. We can quantify the fit like so:</p>
<pre class="prettyprint"><code>sentFit =
  LinearModelFit[
    Thread[
      {
        ageComLenPlotList[[All, 2]],
        ageComSentPlotList[[All, 2]]
        }
      ],
    chars,
    chars
    ]

(*Out:*)</code></pre>


<p><img alt="post-13-8965116933799480070" src="https://b3m2a1.github.io/img/post-13-8965116933799480070.png" /></p>
<p>So we get a weak-negative correlation between comment length and sentiment. Then we can pull the goodness-of-fit:</p>
<pre class="prettyprint"><code>sentFit[&quot;RSquared&quot;]

(*Out:*)

0.218534</code></pre>


<p>And yes, this is a pretty terrible fit, but much better than one might expect for such a messy set of data.</p>
<p><a id="conclusions" style="width:0;height:0;margin:0;padding:0;">&zwnj;</a></p>
<h2>Conclusions</h2>
<p>With all of that, I think this has gone on long enough, but we can restate some basic conclusions we found.</p>
<ol>
<li>
<p>We can model the expected length of a comment by considering three terms: 1) a standard  <a href="https://reference.wolfram.com/language/ref/GammaDistribution.html"><code>GammaDistribution</code></a>  that models a basic discrete, always positive process 2) a very broad  <a href="https://reference.wolfram.com/language/ref/NormalDistribution.html"><code>NormalDistribution</code></a>  that captures the breadth of comment distributions 3) a very small, sharp  <a href="https://reference.wolfram.com/language/ref/NormalDistribution.html"><code>NormalDistribution</code></a>  that recovers the fact that there is a limit to comment lengths and many people will push right up to it.</p>
</li>
<li>
<p>The standard language used on the stack exchange skews towards bug-fixes and workarounds, as compared to standard English. This might tell us something about how buggy and how many dark corners a huge chunk of software like Mathematica can have.</p>
</li>
<li>
<p>Reputation and comment mentions are directly correlated, but some people are particularly highly mentioned for their rep. This could easily be an artifact of the dataset, or it could describe relative proclivities for conversing in the comments.</p>
</li>
<li>
<p>User age and mean comment length are negatively correlated, while user age and mean comment sentiment have no connection whatsoever.</p>
</li>
<li>
<p>Negative sentiment as expressed in comments is largely constant across ages, but positive and neutral sentiment are reasonably closed coupled, causing the dynamics we saw in the mean sentiment analysis</p>
</li>
<li>
<p>Mean comment length and mean comment sentiment are negatively correlated with each other. What causes this is anyone’s guess, but it’s, at minimum, and interesting correlation</p>
</li>
</ol>
  </div>
</article>
<hr>
<div id="disqus_thread"></div>
<script>
  var disqus_config = function() {
    this.page.url = 'https://b3m2a1.github.io/comment-analysis-of-the-mathematica-stackexchange.html';
      this.page.identifier = 'comment-analysis-of-the-mathematica-stackexchange'
;
  };
  (function() {
    var d = document;
    var s = d.createElement('script');
    s.src = '//b3m2a1-home.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  })();
</script>
<noscript class="text-muted">
  Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
      </div>
    </div>

  </div>

  <footer class="footer">
    <p class="col-sm-6 text-sm-right text-muted acknowledgement">
      Generated by
      <a href="https://github.com/getpelican/pelican" target="_blank">Pelican</a> /
      Forked from <a href="https://github.com/nairobilug/pelican-alchemy" target="_blank">alchemy</a>
    </p>
  </footer>

</body>

</html>